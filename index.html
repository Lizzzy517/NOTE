<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Liz's Europe Flight Radar 2026</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Orbitron:wght@400;700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --blue-sky: #87CEEB; --deep-blue: #1e3a8a; --gold: #d8b25c;
      --mono: "Orbitron", monospace; --display: "Cinzel", serif;
    }
    body { margin: 0; font-family: "Cormorant Garamond", serif; color: white; min-height: 100vh; background: linear-gradient(to bottom, var(--blue-sky), var(--deep-blue)); overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; }
    
    .cloud { position: absolute; background: white; border-radius: 50%; opacity: 0.5; filter: blur(15px); z-index: 1; animation: float 30s infinite linear; }
    .c1 { width: 200px; height: 60px; top: 10%; left: -200px; }
    .c2 { width: 300px; height: 80px; top: 40%; left: -300px; animation-delay: 5s; }
    .c3 { width: 150px; height: 50px; top: 70%; left: -150px; animation-delay: 15s; }
    @keyframes float { 0% { transform: translateX(0); } 100% { transform: translateX(calc(100vw + 300px)); } }

    .wrap { width: min(860px, 95%); z-index: 10; position: relative; }
    .card-container { background: rgba(255,255,255,0.1); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-radius: 25px; padding: 25px; border: 1px solid rgba(255,255,255,0.3); box-shadow: 0 20px 50px rgba(0,0,0,0.4); text-align: center; }

    #boardingPass { background: linear-gradient(160deg, #FDFDFD, #E8F1F8); color: #333; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); max-width: 420px; margin: 0 auto; text-align: left; font-family: var(--mono); border: 1px dashed #999; }
    .bp-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--deep-blue); margin-bottom: 20px; padding-bottom: 10px; }
    .bp-field { font-size: 10px; color: #777; margin-bottom: 15px; }
    .bp-field span { display: block; font-size: 18px; font-weight: bold; color: #111; }
    .barcode { width: 100%; height: 50px; background: repeating-linear-gradient(90deg, #000 0 2px, #fff 2px 5px); margin-top: 20px; opacity: 0.8; }

    #airplaneScene { display: none; flex-direction: column; align-items: center; }
    .airplane-img { width: 100px; animation: flyPlane 4s infinite ease-in-out; }
    @keyframes flyPlane { 0%, 100% { transform: translateY(0) rotate(5deg); } 50% { transform: translateY(-15px) rotate(2deg); } }

    #trackerUI { display: none; }
    .status-badge { display: inline-block; padding: 10px 30px; border-radius: 50px; background: var(--gold); color: #000; font-family: var(--mono); font-weight: 700; margin-bottom: 30px; box-shadow: 0 0 20px rgba(216,178,92,0.5); }

    .journey-map { position: relative; margin: 100px 0 60px 0; padding: 0 25px; }
    .map-line { height: 4px; background: rgba(255,255,255,0.2); position: relative; border-radius: 2px; }
    .map-progress { height: 100%; background: var(--gold); width: 0%; position: absolute; box-shadow: 0 0 10px var(--gold); transition: width 0.5s linear; }
    
    .plane-container { position: absolute; top: -55px; transform: translateX(-50%); transition: left 0.5s linear; z-index: 15; display: flex; flex-direction: column; align-items: center; }
    .flight-tag { background: #000; color: var(--gold); font-family: var(--mono); font-size: 11px; font-weight: bold; padding: 3px 10px; border-radius: 4px; border: 1px solid var(--gold); margin-bottom: 6px; white-space: nowrap; opacity: 0; }
    .flight-tag.visible { opacity: 1; }
    .plane-icon { font-size: 30px; }

    .node-wrap { position: absolute; top: -8px; left: 0; width: 100%; height: 20px; }
    .node { position: absolute; width: 18px; height: 18px; background: #fff; border-radius: 50%; border: 3px solid var(--deep-blue); transform: translateX(-50%); }
    .node.reached { background: var(--gold); border-color: #fff; }
    .node-label { position: absolute; top: 28px; left: 50%; transform: translateX(-50%); font-size: 11px; font-weight: bold; font-family: var(--mono); color: white; }

    .photo-frame { width: 100%; max-width: 250px; margin: 0 auto 20px; background: white; padding: 12px 12px 35px 12px; box-shadow: 0 15px 30px rgba(0,0,0,0.5); transform: rotate(-3deg); display: none; }
    .photo-frame img { width: 100%; height: auto; display: block; border: 1px solid #eee; }

    .report-box { background: rgba(255,255,255,0.05); border: 1px solid rgba(216,178,92,0.3); border-radius: 15px; padding: 20px; margin-top: 30px; }
    #sheetStatus { font-style: italic; color: var(--gold); font-size: 18px; margin-top: 10px; }

    button { padding: 15px 40px; border-radius: 50px; border: none; cursor: pointer; font-weight: bold; font-family: var(--mono); background: var(--gold); color: #000; transition: 0.3s; }
    
    #betaConsole { position: fixed; bottom: 10px; right: 10px; z-index: 999; }
    .beta-btn { font-size: 8px; padding: 10px; opacity: 0.5; background: #000; color: #0f0; border: 1px solid #0f0; cursor: pointer; border-radius: 5px; }
    .beta-panel { display: none; background: #000; padding: 10px; border: 1px solid #0f0; border-radius: 8px; width: 240px; max-height: 80vh; overflow-y: auto; }
    .beta-panel button { width: 100%; font-size: 10px; padding: 8px; margin: 2px 0; background: #111; color: #fff; text-align: left; border-radius: 4px; }
  </style>
</head>
<body>

  <div class="cloud c1"></div><div class="cloud c2"></div><div class="cloud c3"></div>

  <main class="wrap">
    <section class="card-container">
      <div id="boardingPass">
        <div class="bp-header"><h2 style="margin:0;">BOARDING PASS</h2><span>‚úàÔ∏è</span></div>
        <div class="bp-field">PASSENGER NAME<span>ADDIE / SPECIAL ACCESS</span></div>
        <div class="bp-field">FLIGHT NO<span>LIZ-2026-EUR</span></div>
        <div class="bp-field">DESTINATION<span>TPE > LGW > BER > CDG > BKK > TPE</span></div>
        <div class="barcode"></div>
        <div style="text-align:center; margin-top:25px;"><button id="startBtn">START TRACKING</button></div>
      </div>

      <div id="airplaneScene">
        <img src="https://cdn-icons-png.flaticon.com/512/984/984233.png" class="airplane-img">
        <h2 id="statusText" style="color:var(--gold); font-family:var(--display); margin-top:25px;">Radar Synchronizing...</h2>
        <div id="checkinTimer" style="font-family:var(--mono); font-size:15px; margin: 20px 0;"></div>
        <button id="finalEntryBtn" style="display:none;">ACTIVATE RADAR</button>
      </div>

      <div id="trackerUI">
        <div class="status-badge" id="currentAction">SCANNING...</div>
        <div class="journey-map">
          <div class="plane-container" id="planeContainer">
            <div class="flight-tag" id="flightTag">--</div>
            <div class="plane-icon">‚úàÔ∏è</div>
          </div>
          <div class="map-line"><div class="map-progress" id="mapFill"></div></div>
          <div class="node-wrap" id="nodeContainer"></div>
        </div>
        <div class="report-box">
          <div class="photo-frame" id="photoFrame"><img src="" id="livePhoto"></div>
          <div style="font-size:11px; text-transform:uppercase; color:var(--gold); font-family:var(--mono);">Message from Liz:</div>
          <div id="sheetStatus">Waiting for signal...</div>
        </div>
      </div>
    </section>
  </main>

  <div id="betaConsole">
    <div class="beta-panel" id="betaPanel">
      <div style="color:#0f0; font-size:10px; margin-bottom:5px;">TEST JOURNEY STAGES</div>
      <button onclick="testTime('2026-02-13T22:00:00')">1. ‚úàÔ∏è TPE ‚ûî LGW</button>
      <button onclick="testTime('2026-02-16T12:00:00')">2. üá¨üáß STAYING UK</button>
      <button onclick="testTime('2026-02-19T11:45:00')">3. ‚úàÔ∏è LGW ‚ûî BER</button>
      <button onclick="testTime('2026-02-21T12:00:00')">4. üá©üá™ STAYING BER</button>
      <button onclick="testTime('2026-02-23T07:15:00')">5. ‚úàÔ∏è BER ‚ûî CDG</button>
      <button onclick="testTime('2026-02-25T12:00:00')">6. üá´üá∑ STAYING CDG</button>
      <button onclick="testTime('2026-02-28T22:00:00')">7. ‚úàÔ∏è CDG ‚ûî BKK</button>
      <button onclick="testTime('2026-03-01T10:00:00')">8. üáπüá≠ STAYING BKK (12H)</button>
      <button onclick="testTime('2026-03-01T20:00:00')">9. ‚úàÔ∏è BKK ‚ûî TPE</button>
      <button onclick="testTime('2026-03-02T12:00:00')">10. üè† LANDED TPE</button>
      <button onclick="togglePanel()" style="background:#400; text-align:center;">CLOSE</button>
    </div>
    <div class="beta-btn" onclick="togglePanel()">BETAÊ∏¨Ë©¶ÊåâÈàï</div>
  </div>

  <script>
const CONFIG = { 
  sheetUrl: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ5jpWMX7wsapbbktd_fSsiTt4upzxxGi1ydGf9Wt8dfUISCvcdgzZ3oNc6ClwBB8AebBUgmZFvO-lV/pubhtml" 
};

    // Á≠âË∑ùÂ∫ßÊ®ôÔºö5ÊÆµÈ£õË°åÔºåÂúìÈªû‰ΩçÁΩÆÂàÜÂà•ÊòØ 0, 20, 40, 60, 80, 100
    const NODE_POS = [0, 20, 40, 60, 80, 100]; 
    const NODE_LABELS = ["TPE", "LGW", "BER", "CDG", "BKK", "TPE"];

    const FLIGHT_PLAN = [
      { id: "SQ312", start: "2026-02-13T17:35:00", end: "2026-02-14T06:35:00", stay: "STAYING UK üá¨üáß" },
      { id: "FR147", start: "2026-02-19T10:00:00", end: "2026-02-19T13:35:00", stay: "STAYING BER üá©üá™" },
      { id: "EJU5147", start: "2026-02-23T06:00:00", end: "2026-02-23T08:30:00", stay: "STAYING CDG üá´üá∑" },
      { id: "TG931", start: "2026-02-28T12:00:00", end: "2026-03-01T06:00:00", stay: "STAYING BKK (12H) üáπüá≠" },
      { id: "TG636", start: "2026-03-01T17:00:00", end: "2026-03-01T22:10:00", stay: "LANDED TPE üè†" }
    ];

    let fakeTime = null;

    // ÂàùÂßãÂåñÂúìÈªû
    const nc = document.getElementById('nodeContainer');
    NODE_POS.forEach((p, i) => {
      const d = document.createElement('div');
      d.className = 'node'; d.id = 'n'+i; d.style.left = p+'%';
      d.innerHTML = `<span class="node-label">${NODE_LABELS[i]}</span>`;
      nc.appendChild(d);
    });

    document.getElementById('startBtn').onclick = () => {
      document.getElementById('boardingPass').style.display = 'none';
      document.getElementById('airplaneScene').style.display = 'flex';
      runClock();
    };

    function runClock() {
      const now = fakeTime || new Date();
      const dep = new Date(FLIGHT_PLAN[0].start);
      if (dep - now <= 0) {
        document.getElementById('statusText').innerText = "Signal Locked";
        document.getElementById('checkinTimer').style.display = 'none';
        document.getElementById('finalEntryBtn').style.display = 'inline-block';
      } else {
        const diff = dep - now;
        const d = Math.floor(diff/86400000), h = Math.floor((diff%86400000)/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
        document.getElementById('checkinTimer').innerText = `DEPARTURE IN: ${d}d ${h}h ${m}m ${s}s`;
        setTimeout(runClock, 1000);
      }
    }

    document.getElementById('finalEntryBtn').onclick = () => {
      document.getElementById('airplaneScene').style.display = 'none';
      document.getElementById('trackerUI').style.display = 'block';
      setInterval(updateRadar, 1000); 
      setInterval(syncSheet, 15000); // ÊØè 15 ÁßíÊõ¥Êñ∞‰∏ÄÊ¨°
syncSheet(); // ÈÄ≤ÂÖ•Áï´Èù¢Á´ãÂàªÊõ¥Êñ∞‰∏ÄÊ¨°
      
    };

    function updateRadar() {
      const now = fakeTime || new Date();
      let progress = 0, action = "READY", flying = false, callsign = "";
      const step = 20; 

      FLIGHT_PLAN.forEach((f, i) => {
        const s = new Date(f.start), e = new Date(f.end);
        if (now >= s && now <= e) {
          flying = true; callsign = f.id;
          action = `FLYING TO ${NODE_LABELS[i+1]} ‚úàÔ∏è`;
          let ratio = (now - s) / (e - s);

          // ‚ú®„ÄêCDG ‚ûî BKK Ë¶ñË¶∫ÁΩÆ‰∏≠Âº∑Âåñ„Äë‚ú®
          if (i === 3) { 
            // ËÆìÊØîÁéáÂú® 0.1~0.9 ‰πãÈñìÊôÇÔºåË¶ñË¶∫‰∏äÈÉΩÁõ°ÈáèÈù†Ëøë‰∏≠ÂøÉ
            ratio = (1 - Math.cos(ratio * Math.PI)) / 2;
          }

          progress = (i * step) + (ratio * step);
        } else if (now > e) {
          document.getElementById('n' + (i + 1)).classList.add('reached');
          progress = (i + 1) * step;
          action = f.stay;
        } else {
          document.getElementById('n' + (i + 1)).classList.remove('reached');
        }
      });

      const tag = document.getElementById('flightTag');
      if (flying) { tag.innerText = callsign; tag.classList.add('visible'); } 
      else { tag.classList.remove('visible'); }

      document.getElementById('currentAction').innerText = action;
      document.getElementById('mapFill').style.width = Math.min(progress, 100) + "%";
      document.getElementById('planeContainer').style.left = Math.min(progress, 100) + "%";
      document.getElementById('n0').classList.add('reached');
    }

    async function syncSheet() {
      try {
        const res = await fetch(CONFIG.sheetUrl + "&t=" + Date.now());
        const data = await res.text();
        const rows = data.split("\n");
        const cols = rows[1].split(","); 
        document.getElementById('sheetStatus').innerText = cols[1] || "Ë°õÊòüÈÄ£Á∑ö‰∏≠...";
        const pUrl = cols[2];
        const frame = document.getElementById('photoFrame'), img = document.getElementById('livePhoto');
        if (pUrl && pUrl.trim().length > 10) { img.src = pUrl.trim(); frame.style.display = 'block'; }
        else { frame.style.display = 'none'; }
      } catch (e) { }
    }
async function syncSheet() {
      try {
        console.log("Ê≠£Âú®ÂòóË©¶ÈÄ£Á∑ö Google Sheet..."); // Â¶≥ÂèØ‰ª•Âú®ÁÄèË¶ΩÂô®Êåâ F12 ÁúãÂà∞ÈÄôÂÄã
        const res = await fetch(CONFIG.sheetUrl + "&t=" + Date.now());
        const data = await res.text();
        const rows = data.split("\n");
        
        // ÊäìÂèñÁ¨¨‰∫åÂàó (index 1)
        if (rows.length > 1) {
          const cols = rows[1].split(","); 
          // cols[1] ÊòØ B Ê¨Ñ (ÊñáÂ≠ó)Ôºåcols[2] ÊòØ C Ê¨Ñ (ÁÖßÁâá)
          document.getElementById('sheetStatus').innerText = cols[1] || "Liz Ê≠£Âú®Ë∂ïË∑Ø‰∏≠...";
          
          const pUrl = cols[2] ? cols[2].trim() : "";
          const frame = document.getElementById('photoFrame');
          const img = document.getElementById('livePhoto');
          
          if (pUrl.length > 10) { 
            img.src = pUrl; 
            frame.style.display = 'block'; 
          } else {
            frame.style.display = 'none';
          }
        }
      } catch (e) {
        console.error("ÈÄ£Á∑öÂ§±Êïó:", e);
        document.getElementById('sheetStatus').innerText = "Ë°õÊòüÈÄ£Á∑öÊö´ÊôÇ‰∏≠Êñ∑...";
      }
    }
    // ‚ú® ‰øÆÊ≠£ÂæåÁöÑ BETA ÊéßÂà∂ÂáΩÂºè ‚ú®
    function togglePanel() { 
      const p = document.getElementById('betaPanel'); 
      p.style.display = (p.style.display === 'block') ? 'none' : 'block'; 
    }

    function testTime(t) { 
      fakeTime = new Date(t); 
      // Á¢∫‰øùÂàáÊèõÂà∞Èõ∑ÈÅîÁï´Èù¢
      document.getElementById('boardingPass').style.display = 'none';
      document.getElementById('airplaneScene').style.display = 'none';
      document.getElementById('trackerUI').style.display = 'block';
      updateRadar(); 
    }
  </script>
</body>
</html>



